install.packages("latex2exp")
install.packages("rddensity")
seatbelts <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Exams/data/midterm/USSeatBelts.csv")
seatbelts80 <- seatbelts %>% filter(year>=1983 & year<=1986) %>% filter(state!="NY" & state!="NJ") %>%
mutate(enforce2 = ifelse(enforce=="no",0,1))
seatbelts80 %>% group_by(year, enforce2) %>% summarize(n = n()) %>% mutate(per = n/sum(n))
library(tidyverse)
library(modelsummary)
seatbelts80 <- seatbelts %>% filter(year>=1983 & year<=1986) %>% filter(state!="NY" & state!="NJ") %>%
mutate(enforce2 = ifelse(enforce=="no",0,1))
seatbelts80 %>% group_by(year, enforce2) %>% summarize(n = n()) %>% mutate(per = n/sum(n))
seatbelts80 %>% filter(enforce2==1) %>% select(state) %>% pull()
seatbelts80 %>% filter(enforce2==0) %>% select(state) %>% pull()
seatbelts[seatbelts$state=="CA"]
seatbelts[seatbelts$state=="CA",]
states_with_seatbelt <- seatbelts80 %>% filter(enforce2==1) %>% select(state) %>% pull()
seatbelts80 <- seatbelts80 %>% mutate(treat = ifelse(state %in% states_with_seatbelt, 1, 0),
after = as.numeric(year>=1986))
lm8 <- lm(fatalities ~ treat*after, data = seatbelts80)
modelsummary(list("Fatalities" = lm8), stars = TRUE, gof_omit = 'DF|AIC|BIC|Log.Lik.|F')
summary(lm(fatalities ~ treat*after, data = seatbelts80))
