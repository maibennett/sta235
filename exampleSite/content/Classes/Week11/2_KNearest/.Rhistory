panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=10
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/15*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=17
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/15*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=29
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/15*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
1126/711
xc = 6
yc = 90
r=10
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=17
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=17
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=22
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=25
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=40
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/15*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=40
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=50
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=47
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=45
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=48
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
xc = 6
yc = 90
r=47
sample1 %>%
ggplot(aes(x = freq, y = spend, label = label)) +
geom_richtext(aes(y = spend), fill = NA, label.color = NA, # remove background and outline
label.padding = grid::unit(rep(0, 4), "pt") # remove padding
) +
ggplot2::annotate("path",
x=xc+r/(15*1.58)*cos(seq(0,2*pi,length.out=100)),
y=yc+r*sin(seq(0,2*pi,length.out=100)), color = "dark grey", lwd = 2) +
theme_bw()+
theme_ipsum_fsc() + #plain
xlab("Frequency") + ylab("Spending ($)")+
ylim(0,150) + xlim(0,10) +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position=c(0.9,0.9),
legend.title = element_text(size = 16),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="dark grey"),
title = element_text(size=14))
data <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/1_Shrinkage/data/purchases.csv")
set.seed(100)
n <- nrow(data)
train.row <- sample(1:n, 0.8*n)
test.data <- data[-train.row,]
train.data <- data[train.row,]
knn <- train(
type ~., data = train.data, method = "knn",
trControl = trainControl("cv", number = 10),
preProcess = c("center","scale"),
tuneLength = 20
)
plot(knn
)
prob <- rescale(data$freq, to = c(0.01,0.99))
data <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/1_Shrinkage/data/purchases.csv")
prob <- rescale(data$freq, to = c(0.01,0.99))
set.seed(100)
d$type = NA
for(i in 1:nrow(data)){
set.seed(i)
d$type[i] = sample(c(1,2),1,prob=c(prob[i],1-prob[i]))
}
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/1_Shrinkage/data/purchases.csv")
prob <- rescale(d$freq, to = c(0.01,0.99))
set.seed(100)
d$type = NA
for(i in 1:nrow(data)){
set.seed(i)
d$type[i] = sample(c(1,2),1,prob=c(prob[i],1-prob[i]))
}
setwd("C:/Users/mc72574/Dropbox/Hugo/Sites/sta235/exampleSite/content/Classes/Week11/2_KNearest")
write.csv(d, file="purchases_type.csv", rownames = FALSE)
write.csv(d, file="purchases_type.csv", row.names = FALSE)
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/1_Shrinkage/data/purchases_type.csv")
set.seed(100)
n <- nrow(data)
train.row <- sample(1:n, 0.8*n)
test.data <- data[-train.row,]
train.data <- data[train.row,]
knn <- train(
type ~., data = train.data, method = "knn",
trControl = trainControl("cv", number = 10),
preProcess = c("center","scale"),
tuneLength = 20
)
plot(knn)
d <- d %>% mutate(type = factor(type))
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/1_Shrinkage/data/purchases_type.csv")
d <- d %>% mutate(type = factor(type))
set.seed(100)
n <- nrow(d)
train.row <- sample(1:n, 0.8*n)
test.data <- d[-train.row,]
train.data <- d[train.row,]
knn <- train(
type ~., data = train.data, method = "knn",
trControl = trainControl("cv", number = 10),
preProcess = c("center","scale"),
tuneLength = 20
)
plot(knn)
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week11/2_KNN/data/purchases_type.csv")
