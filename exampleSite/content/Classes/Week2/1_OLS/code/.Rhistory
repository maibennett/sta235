######################################################################
### Title: "Week 2 - Multiple Regression: Interactions & Other Issues"
### Course: STA 235H
### Semester: Fall 2023
### Professor: Magdalena Bennett
#######################################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
# scipen=999 removes scientific notation; scipen=0 turns it on.
options(scipen = 0)
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(vtable)
cars <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week2/1_OLS/data/SoCalCars.csv", stringsAsFactors = FALSE)
sumtable(cars)
luxury_brands <- c("Audi", "BMW", "Cadillac", "Ferrari", "Jaguar", "Lamborghini", "Land Rover", "Lexus",
"Maserati", "Mercedes-Benz", "Porsche", "Rolls-Royce", "Tesla", "Volvo")
cars <- cars %>% filter(type == "Used" & year >= 1970 & price < 100000 &
price > 10000 & mileage < 150000) %>% #COMPLETE CODE
mutate(luxury = ifelse(make %in% luxury_brands, 1, 0),
price = price/1000, #COMPLETE CODE
mileage = mileage/1000, #COMPLETE CODE
year = year - 1970) #COMPLETE CODE
ggplot(data = cars, aes(y = price, x = year)) +
geom_point(fill = "white", color = "orange", size = 3, pch = 21) + #pch changes the type of the marker (you can see the options here: http://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r)
theme_bw()+
xlab("Year (since 1970)") + ylab("Price (1,000 USD)")
lm2 <- lm(price ~ mileage + rating + year*luxury, data = cars) #COMPLETE THE CODE
summary(lm2)
lm2 <- lm(price ~ mileage + rating + year + luxury + year:luxury, data = cars) #COMPLETE THE CODE
summary(lm2)
lm2 <- lm(price ~ mileage + rating + year*luxury, data = cars) #COMPLETE THE CODE
lm2
summary(lm2)
ggplot(data = cars, aes(x = price)) +
geom_histogram(color = "#BF3984", fill = "white", lwd = 1.5, bins = 40) + #You can change "bins" depending on your data. Make sure you don't have too many or too few! Play around with.
theme_bw()+
xlab("Price (M $)") + ylab("Count")
cars <- cars %>% mutate(log_price = log(price)) #Be careful here! If Y=0, then log is not defined!
lm_log <- lm(log_price ~ rating + mileage + luxury + year, data = cars)
summary(lm_log)
### This is a vector of coefficients
lm_log$coefficients
### This is the coefficient for mileage:
lm_log$coefficients["mileage"]
### This is the percentage change (exact): Exponentiate the coefficient, substract one, and multiply by 100
(exp(lm_log$coefficients["mileage"]) - 1)*100
##### Q: How does this compare with \beta_1*100% ?
lm_log$coefficients["mileage"]*100
