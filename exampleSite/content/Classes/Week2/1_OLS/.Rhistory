title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 35), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Fitted values") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Fitted values") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Fitted values") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Fitted values") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
plot(cars$price, cars$price_hat)
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(price ~ year, data = .)),
residual = price - price_hat)
ggplot(data = cars, aes(x = residual)) + geom_histogram()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(price ~ rating + mileage + year, data = .)),
residual = price - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("Fitted values") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 25), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 5), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 50), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + mileage + log(year), data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) + geom_point()
ggplot(data = cars, aes(x = price, y = year)) + geom_point()
ggplot(data = cars, aes(x = price, y = mileage)) + geom_point()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + log(mileage) + log(year), data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) + geom_point()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + I(mileage^2) + I(year^2) + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) + geom_point()
ggplot(data = cars, aes(x = price, y = mileage^2)) + geom_point()
ggplot(data = cars, aes(x = price, y = log(mileage))) + geom_point()
ggplot(data = cars, aes(x = price, y = log(mileage)^2)) + geom_point()
ggplot(data = cars, aes(x = price, y = log(mileage))) + geom_point()
ggplot(data = cars, aes(x = price, y = log(mileage) + mileage)) + geom_point()
ggplot(data = cars, aes(x = price, y = log(year))) + geom_point()
ggplot(data = cars, aes(x = price, y = year^2)) + geom_point()
ggplot(data = cars, aes(x = price, y = year^3)) + geom_point()
ggplot(data = cars, aes(x = price, y = year^3 + year + year^2)) + geom_point()
ggplot(data = cars, aes(x = price, y = year^3)) + geom_point()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + log(mileage) + I(year^3) + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price, y = residual)) + geom_point()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = residual)) + geom_histogram()
cars <- cars %>% filter(year>(1994-1970)) %>%
mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = residual)) +
geom_histogram(color = "#BF3984", fill = "white", lwd = 1.5) +
theme_bw()+
xlab("Residuals") + ylab("Count") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = log(price), y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("log(Price)") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("log(Price)") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week2/2_OLS_probs/data/SoCalCars.csv", stringsAsFactors = FALSE)
## Let's clean some data
# Select only cars from the year 1970 onwards, that are under $100k, and have less than 150k miles.
# Let's create new variables:
# luxury: dummy variable for luxury brands (in `luxury_brand` vector) (source: https://luxe.digital/business/digital-luxury-ranking/best-luxury-car-brands/)
# Transform price from dollars to thousands of dollars, and miles to thousands of miles.
# Transform year so that it's the number of years since 1970s
luxury_brands <- c("Audi", "BMW", "Cadillac", "Ferrari", "Jaguar", "Lamborghini", "Land Rover", "Lexus",
"Maserati", "Mercedes-Benz", "Porsche", "Rolls-Royce", "Tesla", "Volvo")
cars <- cars %>% filter(type != "new" & mileage >= 10000 & mileage <= 150000 & price < 100000 & year >= 1970) %>%
mutate(luxury = ifelse(make %in% luxury_brands, 1, 0),
price = price/1000,
mileage = mileage/1000,
year = year - 1970)
cars <- cars %>% mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = residual)) + geom_histogram()
cars <- cars %>% mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = residual)) +
geom_histogram(color = "#BF3984", fill = "white", lwd = 1.5) +
theme_bw()+
xlab("Residuals") + ylab("Count") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("log(Price)") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 2.2), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 3), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 2.2), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 3), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- cars %>% mutate(price_hat = predict(lm(price ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = residual)) + geom_histogram()
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("log(Price)") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- cars %>% mutate(price_hat = predict(lm(price ~ rating + mileage + year, data = .)),
residual = price - price_hat)
ggplot(data = cars, aes(x = residual)) +
geom_histogram(color = "#BF3984", fill = "white", lwd = 1.5) +
theme_bw()+
xlab("Residuals") + ylab("Count") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
theme_bw()+
xlab("log(Price)") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 10), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 28), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
cars <- cars %>% mutate(price_hat = predict(lm(log(price) ~ rating + mileage + year, data = .)),
residual = log(price) - price_hat)
ggplot(data = cars, aes(x = price_hat, y = residual)) + geom_point()
ggplot(data = cars, aes(x = price_hat, y = residual)) +
geom_point(color = "#BF3984", fill = "white", pch=21, size = 3) +
geom_vline(aes(xintercept = 2.2), color = "#5601A4", lwd = 1.2) +
geom_vline(aes(xintercept = 3), color = "#5601A4", lwd = 1.2) +
geom_hline(aes(yintercept = 0), color = "dark grey", lwd = 1) +
theme_bw()+
xlab("Price") + ylab("Residuals") +
theme_ipsum_fsc(plot_title_face = "bold",plot_title_size = 24) + #plain
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"))+
theme(axis.title.x = element_text(size=18),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=14),
axis.title.y = element_text(size=18),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=14),legend.position="none",
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.background = element_rect(fill="white",colour ="white"),
title = element_text(size=14))
pagedown::chrome_print('C:/Users/mc72574/Dropbox/Hugo/Sites/sta235/exampleSite/content/Classes/Week2/4_OLS_probs/f2021_sta235h_4_reg.html')
pagedown::chrome_print('C:/Users/mc72574/Dropbox/Hugo/Sites/sta235/exampleSite/content/Classes/Week2/2_OLS_probs/f2021_sta235h_4_reg.html')
pagedown::chrome_print('C:/Users/mc72574/Dropbox/Hugo/Sites/sta235/exampleSite/content/Classes/Week2/1_OLS/f2021_sta235h_3_reg.html')
