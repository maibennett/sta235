##############################################################
### Title: "Week 5 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2022
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
library(estimatr)
#install.packages(modelsummary)
library(modelsummary)
## Are Emily and Greg More Employable Than Lakisha and Jamal? Example of an audit study
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week5/2_RCT/data/lakisha_aer.csv")
d <- d %>% mutate(treat = ifelse(race=="b", 1, 0))
xtab(~ treat, data = d)
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% summarize()
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% summarize(count = n())
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% count()
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% table()
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% table(.)
table(d$treat)
?table
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% base::table(.)
## Q: How many treated observations are there? And how many control?
d %>% group_by(treat) %>% count()
# We are going to create another dataset that only contains the variables we want to compare (baseline covariates/characteristics + the treatment variable)
d_bal <- d %>% select(treat, education, ofjobs, yearsexp,
computerskills, h, l, city)
# We will use datasummary_balance() to get a pretty table
datasummary_balance(~ treat, data = d_bal,
title = "Balance table", fmt=2,
dinm_statistic = "p.value") # Q: Does education make sense as a continuous variable?
d <- d %>% mutate(boston = ifelse(city=="b",1,0))
d_bal <- d %>% select(treat, education, ofjobs, yearsexp,
computerskills, h, l, boston)
datasummary_balance(~ treat, data = d_bal,
title = "Balance table", fmt=2,
dinm_statistic = "p.value")
summary(lm_robust(call ~ treat, data = d)) #Question: Why do we use lm_robust() and not lm()?
summary(lm_robust(call ~ treat + factor(education) + ofjobs + yearsexp + computerskills + h + factor(city), data = d))
##############################################################
### Title: "Week 5 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2022
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
library(estimatr)
#install.packages(modelsummary)
library(modelsummary)
## Are Emily and Greg More Employable Than Lakisha and Jamal? Example of an audit study
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week5/2_RCT/data/lakisha_aer.csv")
d <- d %>% mutate(treat = ifelse(race == "b", 1, 0))
d %>% group_by(treat) %>% count() # group_by() groups your data according to the different levels of the variables in the argument (in this case, treat).
# We are going to create another dataset that only contains the variables we want to compare (baseline covariates/characteristics + the treatment variable)
d_bal <- d %>% select(treat, education, ofjobs, yearsexp,
computerskills, h, l, city)
# We will use datasummary_balance() to get a pretty table
datasummary_balance(~ treat, data = d_bal,
title = "Balance table", fmt=2,
dinm_statistic = "p.value") # Q: Does education make sense as a continuous variable?
summary(lm_robust(call ~ treat, data = d)) #Question: Why do we use lm_robust() and not lm()?
summary(lm_robust(call ~ treat + factor(education) + ofjobs +
yearsexp + computerskills + h + factor(city), data = d))
