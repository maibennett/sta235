xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=1,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
ggplot(data = d, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=1,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
ggplot(data = d, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 45,hjust=1,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 45,hjust=1,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
library(ggplot2)
library(dplyr)
library(MatchIt)
library(tidyverse)
library(hrbrthemes)
library(firasans)
set.seed(101)
d = rbind(cbind(rnorm(100,0,1),-3,0,seq(1,100)),
cbind(rnorm(100,0,1),-2,0,seq(1,100)),
cbind(rnorm(100,0,1),-1,0,seq(1,100)),
cbind(rnorm(100,0,1),0,0,seq(1,100)),
cbind(rnorm(100,0,1),1,0,seq(1,100)),
cbind(rnorm(100,0,1),2,0,seq(1,100)),
cbind(rnorm(100,0,1),3,0,seq(1,100)),
cbind(rnorm(100,0.5,1),-3,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),0,1,seq(101,200)),
cbind(rnorm(100,0.5,1),1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),3,1,seq(101,200)))
d = as.data.frame(d)
names(d) = c("x","t","z","id")
d$y = d$x + rnorm(nrow(d),0.5,0.05)
g1 = ggplot(data = d, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
### Matching
d_wide = d %>% pivot_wider(id_cols = id, names_from = t, values_from = y, names_prefix = "y")
d_wide$z = 0
d_wide$z[d_wide$id %in% unique(d$id[d$z==1])] = 1
match.1 = matchit(z ~ `y-3` + `y-2` + `y-1` + `y0`, data = d_wide, method = "nearest", discard = "both", caliper = 0.3)
d_m <- match.data(match.1)
table(d_m$z)
dm = pivot_longer(d_m, cols = starts_with("y"), names_to = "y")
dm$t = NA
dm$t[dm$y=="y-3"] = -3
dm$t[dm$y=="y-2"] = -2
dm$t[dm$y=="y-1"] = -1
dm$t[dm$y=="y0"] = -0
dm$t[dm$y=="y1"] = 1
dm$t[dm$y=="y2"] = 2
dm$t[dm$y=="y3"] = 3
dm$y = dm$value
g2 = ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14))
gridExtra
library(gridExtra)
?grid.arrange
grid.arrange(g1,g2)
?grid.arrange
?margin
ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14)) +
theme(plot.margin = unit(c(0.5,1,0.5,1), "cm"))
library(ggplot2)
library(dplyr)
library(MatchIt)
library(tidyverse)
library(hrbrthemes)
library(firasans)
library(gridExtra)
set.seed(101)
d = rbind(cbind(rnorm(100,0,1),-3,0,seq(1,100)),
cbind(rnorm(100,0,1),-2,0,seq(1,100)),
cbind(rnorm(100,0,1),-1,0,seq(1,100)),
cbind(rnorm(100,0,1),0,0,seq(1,100)),
cbind(rnorm(100,0,1),1,0,seq(1,100)),
cbind(rnorm(100,0,1),2,0,seq(1,100)),
cbind(rnorm(100,0,1),3,0,seq(1,100)),
cbind(rnorm(100,0.5,1),-3,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),0,1,seq(101,200)),
cbind(rnorm(100,0.5,1),1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),3,1,seq(101,200)))
d = as.data.frame(d)
names(d) = c("x","t","z","id")
d$y = d$x + rnorm(nrow(d),0.5,0.05)
g1 = ggplot(data = d, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14)) +
theme(plot.margin = unit(c(0.5,1,0.5,1), "cm"))
### Matching
d_wide = d %>% pivot_wider(id_cols = id, names_from = t, values_from = y, names_prefix = "y")
d_wide$z = 0
d_wide$z[d_wide$id %in% unique(d$id[d$z==1])] = 1
match.1 = matchit(z ~ `y-3` + `y-2` + `y-1` + `y0`, data = d_wide, method = "nearest", discard = "both", caliper = 0.3)
d_m <- match.data(match.1)
table(d_m$z)
dm = pivot_longer(d_m, cols = starts_with("y"), names_to = "y")
dm$t = NA
dm$t[dm$y=="y-3"] = -3
dm$t[dm$y=="y-2"] = -2
dm$t[dm$y=="y-1"] = -1
dm$t[dm$y=="y0"] = -0
dm$t[dm$y=="y1"] = 1
dm$t[dm$y=="y2"] = 2
dm$t[dm$y=="y3"] = 3
dm$y = dm$value
g2 = ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14)) +
theme(plot.margin = unit(c(0.5,1,0.5,1), "cm"))
grid.arrange(g1,g2)
library(ggplot2)
library(dplyr)
library(MatchIt)
library(tidyverse)
library(hrbrthemes)
library(firasans)
library(gridExtra)
set.seed(101)
d = rbind(cbind(rnorm(100,0,1),-3,0,seq(1,100)),
cbind(rnorm(100,0,1),-2,0,seq(1,100)),
cbind(rnorm(100,0,1),-1,0,seq(1,100)),
cbind(rnorm(100,0,1),0,0,seq(1,100)),
cbind(rnorm(100,0,1),1,0,seq(1,100)),
cbind(rnorm(100,0,1),2,0,seq(1,100)),
cbind(rnorm(100,0,1),3,0,seq(1,100)),
cbind(rnorm(100,0.5,1),-3,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),-1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),0,1,seq(101,200)),
cbind(rnorm(100,0.5,1),1,1,seq(101,200)),
cbind(rnorm(100,0.5,1),2,1,seq(101,200)),
cbind(rnorm(100,0.5,1),3,1,seq(101,200)))
d = as.data.frame(d)
names(d) = c("x","t","z","id")
d$y = d$x + rnorm(nrow(d),0.5,0.05)
g1 = ggplot(data = d, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Not matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14)) +
theme(plot.margin = unit(c(0,1,0,1), "cm"))
### Matching
d_wide = d %>% pivot_wider(id_cols = id, names_from = t, values_from = y, names_prefix = "y")
d_wide$z = 0
d_wide$z[d_wide$id %in% unique(d$id[d$z==1])] = 1
match.1 = matchit(z ~ `y-3` + `y-2` + `y-1` + `y0`, data = d_wide, method = "nearest", discard = "both", caliper = 0.3)
d_m <- match.data(match.1)
table(d_m$z)
dm = pivot_longer(d_m, cols = starts_with("y"), names_to = "y")
dm$t = NA
dm$t[dm$y=="y-3"] = -3
dm$t[dm$y=="y-2"] = -2
dm$t[dm$y=="y-1"] = -1
dm$t[dm$y=="y0"] = -0
dm$t[dm$y=="y1"] = 1
dm$t[dm$y=="y2"] = 2
dm$t[dm$y=="y3"] = 3
dm$y = dm$value
g2 = ggplot(data = dm, aes(x = factor(t), y = y, fill=factor(z), color=factor(z))) +
geom_vline(xintercept = "0", lty=2) +
geom_boxplot(position = "dodge") +
geom_smooth(aes(group = factor(z))) +
scale_color_manual(values=c("#F89441","#900DA4")) +
scale_fill_manual(values=c(alpha("#F89441",0.3),alpha("#900DA4",0.3))) +
theme_bw()+
theme_ipsum_fsc(plot_title_face = "bold") + #plain
xlab("Time") + ylab("Outcome")+ ggtitle("Matched") +
theme(plot.margin=unit(c(1,1,1.5,1.2),"cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.line = element_line(colour = "dark grey"),legend.position="none")+
theme(axis.title.x = element_text(size=16),#margin = margin(t = 10, r = 0, b = 0, l = 0)),
axis.text.x = element_text(size=10,angle = 0,hjust=0.5,vjust=1,margin=margin(0.1,0,0,0)),
axis.title.y = element_text(size=16),#margin = margin(t = 0, r = 10, b = 0, l = 0)),
axis.text.y = element_text(size=10),legend.position="none",
title = element_text(size=14)) +
theme(plot.margin = unit(c(0,1,0,1), "cm"))
grid.arrange(g1,g2)
pagedown::chrome_print('C:/Users/mc72574/Dropbox/Hugo/Sites/sta235/exampleSite/content/Classes/Week3/2_PotentialOutcomes/f2021_sta235h_5_potentialoutcomes.html')
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
## Are Emily and Greg More Employable Than Lakisha and Jamal? Example of an audit study
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week4/2_RCT/data/lakisha_aer.csv")
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week4/2_RCT/data/lakisha_aer.csv")
# Some variables of interest
d <- d %>% mutate(treat = ifelse(race == "b", 1, 0))
d %>% group_by(treat) %>% count()
d_bal <- d %>% select(treat, education, ofjobs, yearsexp, computerskills, h, l, city)
datasummary_balance(~ treat, data = d_bal, title = "Balance table", fmt=2, dinm_statistic = "p.value")
summary(lm_robust(call ~ treat, data = d)) # We use lm_robust() instead of lm() for binary outcomes to get the correct standard errors (we will see this in following classes).
summary(lm_robust(call ~ treat + factor(education) + ofjobs + yearsexp + computerskills + h + factor(city), data = d))
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
## Are Emily and Greg More Employable Than Lakisha and Jamal? Example of an audit study
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week4/2_RCT/data/lakisha_aer.csv")
##############################################################
### Title: "Week 4 - Randomized Controlled Trials"
### Course: STA 235H
### Semester: Fall 2021
### Professor: Magdalena Bennett
##############################################################
# Clears memory
rm(list = ls())
# Clears console
cat("\014")
### Load libraries
# If you don't have one of these packages installed already, you will need to run install.packages() line
library(tidyverse)
library(ggplot2)
#install.packages(estimatr)
library(estimatr)
library(modelsummary)
## Are Emily and Greg More Employable Than Lakisha and Jamal? Example of an audit study
d <- read.csv("https://raw.githubusercontent.com/maibennett/sta235/main/exampleSite/content/Classes/Week4/2_RCT/data/lakisha_aer.csv")
d <- d %>% mutate(treat = ifelse(race == "b", 1, 0))
d_bal <- d %>% select(treat, education, ofjobs, yearsexp, computerskills, h, l, city)
datasummary_balance(~ treat, data = d_bal, title = "Balance table", fmt=2, dinm_statistic = "p.value") # Q: Does education make sense as a continuous variable?
summary(lm_robust(call ~ treat, data = d)) # We use lm_robust() instead of lm() for binary outcomes to get the correct standard errors (we will see this in following classes).
summary(lm_robust(call ~ treat + factor(education) + ofjobs + yearsexp + computerskills + h + factor(city), data = d))
