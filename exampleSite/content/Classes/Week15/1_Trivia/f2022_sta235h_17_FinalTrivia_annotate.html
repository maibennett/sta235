<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>STA 235H - Review Session &amp; Final Trivia</title>
    <meta charset="utf-8" />
    <meta name="author" content="McCombs School of Business, UT Austin" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/fabric/fabric.min.js"></script>
    <link href="libs/xaringanExtra-scribble/scribble.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-scribble/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30,"palette":[]}) })</script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# STA 235H - Review Session &amp; Final Trivia
]
.subtitle[
## Fall 2022
]
.author[
### McCombs School of Business, UT Austin
]

---


&lt;!-- &lt;script type="text/javascript"&gt; --&gt;
&lt;!-- MathJax.Hub.Config({ --&gt;
&lt;!--   "HTML-CSS": { --&gt;
&lt;!--     preferredFont: null, --&gt;
&lt;!--     webFont:  "Neo-Euler" --&gt;
&lt;!--   } --&gt;
&lt;!-- }); --&gt;
&lt;!-- &lt;/script&gt; --&gt;




&lt;style type="text/css"&gt;

.small .remark-code { /*Change made here*/
  font-size: 80% !important;
}

.tiny .remark-code { /*Change made here*/
  font-size: 80% !important;
}
&lt;/style&gt;





# Announcements

- **.darkorange[Homework 7]** is due this Thursday (you **have to** submit it by 11:59PM on Thursday)
  
  - Please make sure to not start a new attempt after you have submitted!

--

- **.darkorange[Final Exam]** will be posted this Friday at 10am.

  - Exam is made for 2hrs `\(\rightarrow\)` you will have **2hrs and 20min** (20 minutes to check answers, upload code, etc.)
  
  - You can start at any point between then and 11:59PM Monday Dec 5th (actually, 9:40PM if you want the full time).
  
--

- **.darkorange[Course evaluations are open]**: Small extra-credit (1/2 point) for completing the survey (just upload a screenshot of the completed status -- not the survey!).

  - Submit until Friday 11:59PM.
  
---
# Rules of Final Trivia

1) **.darkorange[Form groups]**: 2 or 3 students (no more, no less).

--

2) **.darkorange[Choose a name for your group]**: You can be funny or classic.

--

3) **.darkorange[You need to complete all the questions]**: It doesn't matter if you don't know the answer! Make your best guess.

--

4) **.darkorange[Ask questions]**: I will give you time for your team to complete each questions; after the time is up, you will submit your questions and we will check answers.

  - If something isn't clear, **now is the time to ask**.

--

5) **.darkorange[There are prizes]**: At the end of the session, we will crown the three teams that perform the best. If there is a tie in scores, the team that submits their answers the fastest moves up.

--


.center[**.darkorange[Note:]** All slides and answers will be posted on Thursday at 2pm. Make sure to take notes!]

---

.center2[
![](https://media.giphy.com/media/Olr6bYzpBx2JG/giphy.gif)
]

---
.center2[
.box-3trans[Go to the following link and sign up&lt;br&gt;
https://sta235h.rocks/SignUp
]
&lt;br&gt;
&lt;br&gt;
.box-4trans[You can follow the some of the output of the slides here:&lt;br&gt;
https://sta235h.rocks/FinalTrivia
]

]
---
background-position: 50% 50%
class: left, bottom, inverse
.big[
Regressions
]
---
# Insurance costs

In this question, we are looking at insurance costs. We have data on insurance premiums in addition to individual data from the customers:


```r
insurance &lt;- read.csv("https://raw.githubusercontent.com/maibennett/website_github/master/exampleSite/content/files/data/insurance.csv")

head(insurance)
```

```
##   age    sex    bmi children smoker    region   charges
## 1  19 female 27.900        0    yes southwest 16884.924
## 2  18   male 33.770        1     no southeast  1725.552
## 3  28   male 33.000        3     no southeast  4449.462
## 4  33   male 22.705        0     no northwest 21984.471
## 5  32   male 28.880        0     no northwest  3866.855
## 6  31 female 25.740        0     no southeast  3756.622
```

We want to find the relation between these covariates and the outcome (`charges`).

---
# Question 1

Looking at the following output, **what is the difference in charges between a smoker and a non-smoker with a BMI of 22?**. Write down the appropriate number. *Approximate your answer to 2 decimal places.*

.small[

```r
lm1 &lt;- lm(charges ~ smoker*bmi, data = insurance)

summary(lm1)
```

```
## 
## Call:
## lm(formula = charges ~ smoker * bmi, data = insurance)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19768.0  -4400.7   -869.5   2957.7  31055.9 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5879.42     976.87   6.019 2.27e-09 ***
## smokeryes     -19066.00    2092.03  -9.114  &lt; 2e-16 ***
## bmi               83.35      31.27   2.666  0.00778 ** 
## smokeryes:bmi   1389.76      66.78  20.810  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6161 on 1334 degrees of freedom
## Multiple R-squared:  0.7418,	Adjusted R-squared:  0.7412 
## F-statistic:  1277 on 3 and 1334 DF,  p-value: &lt; 2.2e-16
```
]


---
# Question 1: Answer

--

**.darkorange[Answer:]** 11508.72 (i.e. `\(-19.066.00 + 1389.76\times22\)` )

---
# Question 2

Looking at the following output, **what is the association between charges and BMI for smokers?**. Write down the appropriate number. *Approximate your answer to 2 decimal places.*

.small[

```r
lm1 &lt;- lm(charges ~ smoker*bmi, data = insurance)

summary(lm1)
```

```
## 
## Call:
## lm(formula = charges ~ smoker * bmi, data = insurance)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19768.0  -4400.7   -869.5   2957.7  31055.9 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5879.42     976.87   6.019 2.27e-09 ***
## smokeryes     -19066.00    2092.03  -9.114  &lt; 2e-16 ***
## bmi               83.35      31.27   2.666  0.00778 ** 
## smokeryes:bmi   1389.76      66.78  20.810  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6161 on 1334 degrees of freedom
## Multiple R-squared:  0.7418,	Adjusted R-squared:  0.7412 
## F-statistic:  1277 on 3 and 1334 DF,  p-value: &lt; 2.2e-16
```
]

---
# Question 2: Answer

--

**.darkorange[Answer:]** 1473.11 (i.e `\(83.35+1389.76\)` )

---
# Question 3

Looking at the following output, **what is the association between charges and BMI for smokers?**. Write down the &lt;u&gt;interpretation&lt;/u&gt;.

.small[

```r
lm1 &lt;- lm(charges ~ smoker*bmi, data = insurance)

summary(lm1)
```

```
## 
## Call:
## lm(formula = charges ~ smoker * bmi, data = insurance)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19768.0  -4400.7   -869.5   2957.7  31055.9 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5879.42     976.87   6.019 2.27e-09 ***
## smokeryes     -19066.00    2092.03  -9.114  &lt; 2e-16 ***
## bmi               83.35      31.27   2.666  0.00778 ** 
## smokeryes:bmi   1389.76      66.78  20.810  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6161 on 1334 degrees of freedom
## Multiple R-squared:  0.7418,	Adjusted R-squared:  0.7412 
## F-statistic:  1277 on 3 and 1334 DF,  p-value: &lt; 2.2e-16
```
]

---
# Question 3: Answer

--

**.darkorange[Answer:]** For one additional unit increase in BMI, the average increase in insurance charges for smokers is $1473.11.

---
background-position: 50% 50%
class: left, bottom, inverse
.big[
Causal Inference
]
---
# Does Academic Probation Work?

Academic probation is a widely used tool by most universities to make sure students maintain minimum academic standards. In this section, we will analyze data from a large Canadian university regarding the effects of academic probation, originally used in Lindo, Sanders, and Oreopoulos’ (2010) paper, “Ability, Gender, and Performance Standards: Evidence from Academic Probation”

.tiny[

```r
probation &lt;- read.csv("https://raw.githubusercontent.com/maibennett/website_github/master/exampleSite/content/files/data/probation.csv")
```
]
.pull-left[
.small[
- `creditsY`: Credits attempted in year Y = 1,2.
- `credits_earnedY`: Credits earned in year Y = 1,2.
- `GPA_yearY`: GPA at the end of year Y = 1,2.
- `CGPA_yearY`: Cumulative GPA at the end of year Y = 1,2.
- `sex`: Gender of the student (M: Male, F: Female).
- `age_at_entry`: Age of the student when they first enrolled.]]

.pull-right[
.small[
- `gradinY`: Student graduated in Y years, Y = 4, 5, or 6.
- `left_school`: Whether the student left school or not after the first assessment.
- `hsgrade_pct`: Percentile of graduation in their high school.
- `probation_year1`: Whether the student was in academic probation by the end of year 1.
- `suspended_year1`: Whether the student was suspended by the end of year 1.]]

---
# Question 4

First, we would like to analyze whether students that are on academic probation in their first year are more likely to drop out. For this, we run the following regression:

.small[

```r
summary(lm_robust(left_school ~ probation_year1, data = probation))
```

```
## 
## Call:
## lm_robust(formula = left_school ~ probation_year1, data = probation)
## 
## Standard error type:  HC2 
## 
## Coefficients:
##                 Estimate Std. Error t value   Pr(&gt;|t|) CI Lower CI Upper    DF
## (Intercept)      0.03755  0.0009849   38.13 5.691e-313  0.03562  0.03948 44360
## probation_year1  0.07165  0.0038290   18.71  7.761e-78  0.06415  0.07916 44360
## 
## Multiple R-squared:  0.01481 ,	Adjusted R-squared:  0.01479 
## F-statistic: 350.2 on 1 and 44360 DF,  p-value: &lt; 2.2e-16
```
]
.small[
**a-b) What is the percentage of students that drop out of school according to their academic status?** (Use two decimal places)

**c) Is the difference in drop-out rates statistically significant?**

**d) Interpret the coefficient for `probation_year1`**]

---
# Question 4: Answer

--

**.darkorange[Answer:]** On average, 3.8% of students not on academic probation drop out of this college, while that percentage is 10.92% for students in academic probation.The difference is statistically significant.

In terms of interpretation, being on probation is associated to an average increase of dropping out of 7.2 percentage points compared to not being on probation.

---
# Assessing the effect of academic probation

To assess the effect of probation on academic performance, we decide to run the following regression &lt;u&gt;on students that have not dropped out&lt;/u&gt;.

.tiny[

```r
probation &lt;- probation %&gt;% filter(left_school==0)

summary(lm(GPA_year2 ~ probation_year1 + credits1 + credits_earned1 + GPA_year1 + 
     factor(sex) + age_at_entry + hsgrade_pct, data = probation))
```

```
## 
## Call:
## lm(formula = GPA_year2 ~ probation_year1 + credits1 + credits_earned1 + 
##     GPA_year1 + factor(sex) + age_at_entry + hsgrade_pct, data = probation)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.3545 -0.3239  0.0646  0.3708  2.5300 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.0557184  0.0803853  13.133  &lt; 2e-16 ***
## probation_year1  0.2827426  0.0132546  21.332  &lt; 2e-16 ***
## credits1        -0.0069394  0.0120652  -0.575   0.5652    
## credits_earned1  0.0245169  0.0116370   2.107   0.0351 *  
## GPA_year1        0.6971113  0.0059157 117.842  &lt; 2e-16 ***
## factor(sex)M    -0.0957468  0.0061847 -15.481  &lt; 2e-16 ***
## age_at_entry    -0.0248064  0.0041120  -6.033 1.63e-09 ***
## hsgrade_pct      0.0032055  0.0001307  24.529  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.5817 on 38322 degrees of freedom
##   (3857 observations deleted due to missingness)
## Multiple R-squared:  0.5139,	Adjusted R-squared:  0.5139 
## F-statistic:  5789 on 7 and 38322 DF,  p-value: &lt; 2.2e-16
```
]

---
# Question 5

Interpret the coefficient of interest in the previous model.

---
# Question 5: Answer

--

**.darkorange[Answer:]** On average, if students are in academic probation the first year vs not in academic probation, their GPA increases by 0.28 points in their second year, holding other variables constant.

---
# Question 6

Do you think the previous estimate is a causal effect? Why or why not? Give a specific example.

---
# Question 6: Answer

--

**.darkorange[Answer:]**  In order for the previous coefficient to be a causal effect, we need to have controlled for all confounders. However, there are most likely unobserved confounders we are not capturing. For example, more vulnerable students might be more likely to be on academic probation (e.g. they have more responsibilities outside college) and that might also affect directly their GPA the second year.

---
background-position: 50% 50%
class: left, bottom, inverse
.big[
Prediction
]
---
# Candy, candy, candy

In this section, we will be predicting win percentage for candy bars! We have the following dataset for this:

.tiny[

```r
candy &lt;- read.csv("https://raw.githubusercontent.com/maibennett/website_github/master/exampleSite/content/files/data/candy.csv")
```
]

.pull-left[
.small[
- `competitorname`:	Name of the candy
- `chocolate`: Is it chocolate?
- `fruity`: Is it fruit flavored?
- `caramel`: Is there caramel in the candy?
- `peanutalmondy`: Does it contain peanuts, peanut butter or almonds?
- `nougat`:	Does it contain nougat?
- `crispedricewafer`:	Does it contain crisped rice, wafers, or a cookie component?
]]

.pull-right[
.small[
- `hard`: Is it a hard candy?
- `bar`:	Is it a bar?
- `pluribus`: Is it one of many candies in a bag/box? 
- `sugarpercent`:	The percentile of sugar it falls under within the data set.
- `pricepercent`:	The unit price percentile compared to the rest of the set.
- `winpercent`:	The overall win percentage according to 269,000 matchups.]]

---
# Question 7

We ran a simple regression tree for this. Looking at the following tree, what is the predicted outcome for a fruity candy, that has a sugar percent of 60%, doesn't have chocolate, nougat, or peanuts, comes in a bar, and has a price percentile of 0.51?

&lt;img src="f2022_sta235h_17_FinalTrivia_annotate_files/figure-html/rd_linear-1.svg" style="display: block; margin: auto;" /&gt;

---
# Question 7: Answer

--

**.darkorange[Answer:]** The predicted win percentage is 44.

---
# Question 8

Using the code provided [here](https://www.magdalenabennett.com/files/data/Trivia/f2022_sta235h_14_FinalTrivia.R), how does your previous model perform? Write down the number (use two decimal places).

---
# Question 8: Answer

--

**.darkorange[Answer:]** 


```r
round(rmse(dt, test.data),2)
```

```
## [1] 14.26
```


---
# Question 9

Your turn. Fit a random forest to predict the outcome of interest. Tune only the number of randomly selected predictors, and use the code provided as a starting point.

- Provide your code, the optimal number of `mtry`, and the performance of your model.

---
# Question 9: Answer

--


```r
tuneGrid &lt;- expand.grid(
  mtry = 1:11,
  splitrule = "variance",
  min.node.size = 5
)

set.seed(100)

rf &lt;- train(winpercent ~ ., data = train.data,
            method = "ranger",
            tuneGrid = tuneGrid,
            trControl = trainControl(method = "cv", number = 10))

rf$bestTune
```

```
##   mtry splitrule min.node.size
## 5    5  variance             5
```

```r
rmse(rf, test.data)
```

```
## [1] 14.92363
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
